
<!doctype html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SkyGlass • Meteo</title>
    <!-- Font Awesome CDN for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        :root{
            --bg-grad: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
            --card-bg: rgba(255,255,255,0.15);
            --card-blur: 14px;
            --accent:#00d2ff;
            --accent2:#3a7bd5;
            --radius:16px;
            --text-light:#eee;
            --text-dim:#bbb;
        }
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:'Segoe UI','Roboto',sans-serif;
            min-height:100vh;
            background:var(--bg-grad);
            color:var(--text-light);
            display:flex;
            align-items:center;
            justify-content:center;
            padding:1rem;
        }
        .app{width:100%;max-width:420px}
        .search{display:flex;gap:.5rem;margin-bottom:1.5rem}
        .search input{
            flex:1;padding:.75rem 1rem;background:var(--card-bg);
            border:none;border-radius:var(--radius);
            backdrop-filter:blur(var(--card-blur));
            color:var(--text-light);font-size:1rem
        }
        .search button{
            padding:.75rem 1.1rem;
            background:linear-gradient(135deg,var(--accent),var(--accent2));
            border:none;border-radius:var(--radius);
            color:#fff;font-weight:600;cursor:pointer
        }
        .card{background:var(--card-bg);border-radius:var(--radius);
               backdrop-filter:blur(var(--card-blur));padding:1.25rem 1.5rem}
        .card h2{font-size:1.5rem;margin-bottom:.5rem}
        .current{display:flex;align-items:center;gap:1rem;margin-bottom:1.2rem}
        .current .temp{font-size:2.8rem;font-weight:600}
        .current .desc{font-size:1rem;color:var(--text-dim)}
        .days{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:.75rem}
        .day{text-align:center;padding:.6rem .3rem;border-radius:var(--radius);
              background:rgba(255,255,255,0.08)}
        .day span{display:block}
        .day .date{font-size:.9rem;margin-bottom:.3rem}
        .day .icon{font-size:1.4rem;margin-bottom:.2rem}
        .day .min{color:var(--text-dim);font-size:.85rem}
        footer{margin-top:1.2rem;text-align:center;font-size:.8rem;color:var(--text-dim)}
    </style>
</head>
<body>
    <div class="app">
        <form class="search" id="searchForm">
            <input placeholder="Cerca città..." id="cityInput" autocomplete="off">
            <button type="submit"><i class="fas fa-search"></i></button>
        </form>
        <div id="result"></div>
        <footer>
            Demo open‑source • dati <a href="https://open-meteo.com" target="_blank" style="color:var(--accent)">Open‑Meteo</a>
        </footer>
    </div>

    <script>
    // --- helpers -----------------------------------------------------------
    const ICONS = {
        0:"fa-sun",1:"fa-cloud-sun",2:"fa-cloud",3:"fa-cloud",
        45:"fa-smog",48:"fa-smog",51:"fa-cloud-rain",53:"fa-cloud-rain",
        55:"fa-cloud-showers-heavy",56:"fa-cloud-meatball",57:"fa-cloud-meatball",
        61:"fa-cloud-showers-heavy",63:"fa-cloud-showers-heavy",65:"fa-cloud-showers-heavy",
        66:"fa-snowflake",67:"fa-snowflake",71:"fa-snowflake",73:"fa-snowflake",
        75:"fa-snowflake",80:"fa-cloud-showers-heavy",81:"fa-cloud-showers-heavy",
        82:"fa-cloud-showers-heavy",95:"fa-bolt",96:"fa-bolt",99:"fa-bolt"
    };
    const icon=(code)=>ICONS[code]||"fa-question";

    async function geocode(q){
        const r=await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(q)}`);
        const j=await r.json();
        if(!j.length) throw 'Località non trovata';
        return {lat:j[0].lat,lon:j[0].lon,name:j[0].display_name};
    }
    async function forecast(lat,lon,tz="Europe/Rome"){
        const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&timezone=${tz}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weathercode`;
        const r=await fetch(url);
        return r.json();
    }
    function render(data,place){
        const cur=data.current_weather;
        const d=data.daily;
        let h=`<div class="card">
            <h2>${place}</h2>
            <div class="current">
                <i class="fa-solid ${icon(cur.weathercode)} fa-2x"></i>
                <div>
                    <div class="temp">${Math.round(cur.temperature)}°</div>
                    <div class="desc">vento ${Math.round(cur.windspeed)} km/h</div>
                </div>
            </div>
            <div class="days">`;
        for(let i=0;i<d.time.length;i++){
            h+=`<div class="day">
                    <span class="date">${d.time[i].slice(5)}</span>
                    <span class="icon"><i class="fa-solid ${icon(d.weathercode[i])}"></i></span>
                    <span class="max">${Math.round(d.temperature_2m_max[i])}°</span>
                    <span class="min">${Math.round(d.temperature_2m_min[i])}°</span>
                </div>`;
        }
        h+=`</div></div>`;
        return h;
    }
    // --- events ------------------------------------------------------------
    document.getElementById('searchForm').addEventListener('submit',async e=>{
        e.preventDefault();
        const q=document.getElementById('cityInput').value.trim();
        if(!q) return;
        const res=document.getElementById('result');
        res.innerHTML="⏳";
        try{
            const g=await geocode(q);
            const data=await forecast(g.lat,g.lon);
            res.innerHTML=render(data,g.name.split(',')[0]);
        }catch(err){
            res.textContent=err;
        }
    });
    </script>
</body>
</html>
